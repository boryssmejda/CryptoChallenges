name: CMake CI

on: [push]

jobs:
    linux-build:
        runs-on: ubuntu-20.04
        steps:
        - name: Check out repository code
          uses: actions/checkout@v2
        - name: Setup CMake
          uses: jwlawson/actions-setup-cmake@v1.9
          with:
            cmake-version: '3.19.x'
        - name: Use CMake
          run: cmake --version
        - name: Setup Python3
          uses: actions/setup-python@v2
          with:
            python-version: '3.9.5'
        - name: Check Python3 version
          run: python3 --version
        - name: Install Conan Package Manager
          run: pip install conan
        - name: Check conan version
          run: conan --version
        - name: Check ninja version
          run: sudo apt-get install -y ninja-build && ninja --version
        - name: Build Project in Debug Mode
          env:
            CXX: g++-10
            CC: gcc-10
          working-directory: ${{ github.workspace }}/scripts
          run: python3 run.py crypto_debug
        - name: Build Project in Release Mode
          env:
            CXX: g++-10
            CC: gcc-10
          working-directory: ${{ github.workspace }}/scripts
          run: python3 run.py crypto_release
